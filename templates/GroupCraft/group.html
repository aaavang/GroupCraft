{% extends 'GroupCraft/base.html' %}
{% block content %}
	<title>{{ name }}</title>
	{% if valid %}
		<div class="row">
			<div class="head" class="twelve columns">
				<h1>{{ name }}</h1>
			</div>

			{% if isAdmin %}
				<div class="head">
				<script type="text/javascript">
					function initializeModal() {
						document.getElementById('id_name_m').value = '{{ name }}';
						document.getElementById('id_description_m').value = '{{ desc }}';
						document.getElementById('id_tags_m').value = "{{ tag_string }}";
					}
				</script>
					<a class="small secondary round button" data-reveal-id="editGroupModal" onclick="initializeModal();">Edit Group Details</a>
				</div>
			{% endif %}
			<hr>
			<div class="row">
				<div class="twelve columns">
					<div class="row">

						<!-- Updated tag cloud -->

						<div class="four hide-for-small columns backborder">
							<h4 class="head">Associated Tags</h4><hr/>
							<div id="myCanvasContainer">
								<canvas width="300" height="300" id="myCanvas">
								</canvas>
							</div>

							<div id="tags">
								<ul>
									{%  for t in tags %}
										<li><a style="font-size: {{ t.count }}pt" href="/groupcraft/tag/{{ t.get_encoded }}">{{ t.get_decoded }}</a></li>
									{% endfor %}
								</ul>
							</div>
						</div>
						<!-- End Cloud -->

						<!-- Groups -->

						<div class="four mobile-two hide-for-small columns backborder">

							<h4 class="head">Group Members</h4><hr/>

							<div class="hide-for-small">
								<h6>Admins: </h6>
								<div class="panel">
									{% if admins %}
										{% for name in admins %}
											<a href="/groupcraft/user/{{ name }}">{{ name }}</a>
											<br>
										{% endfor %}
									{% endif %}
								</div>
								<hr>
								<h6>Members: </h6>
								<div class="panel">
									{% if members %}
										{% for name in members %}
											<a href="/groupcraft/user/{{ name }}">{{ name }}</a>
											{% if isAdmin %}
												<a class="small round alert button" href="/groupcraft/remove/{{ name }}/{{ url }}">&#215;</a>
											{% endif %}
											<br>
										{% endfor %}
									{% else %}
										No Members Yet!<br>
									{% endif %}
								</div>
								<hr>
								<a class="small round button" href="/groupcraft/join_group/{{ url }}">Join This Group!</a><br>
								<br>
							</div>

						</div>

						<!-- End Groups -->

						<!-- Users -->

						<div class="four mobile-two hide-for-small columns backborder">

							<h4 class="head">Posts</h4><hr/>

							{% if posts %}
								{% for p in posts %}
									<div class="panel">
										<h5><a href="/groupcraft/group/{{ p.group.get_url }}">{{ p.title }}</a></h5>

										<h6 class="subheader">
											At {{ p.date }}<br>
											{% if p.replyTo %}
												<b>In response to: {{ p.replyTo.title }} </b> <br>
											{% endif %}
											From <a href="/groupcraft/user/{{ p.author }}">{{ p.author }}</a> <br>
											{{ p.get_snippet }}...
										</h6>
									</div>
								{% endfor %}
							{% else %}
								No Posts Yet!
							{% endif %}
							<hr>
							{% if isMember or isAdmin %}
								<form action="/groupcraft/post/{{ url }}" method="POST">
								<fieldset>
									<legend>Post to this Group</legend>
									{% csrf_token %}
									<label>Title:</label>
									<input type="text" id="title" name="title">
									<label>Text:</label>
									<textarea name="textarea" id="textarea" ></textarea>
									<input type="submit" value="Post">
								</fieldset>
								</form>
							{% endif %}

						</div>

						<!-- End Users -->

					</div>
				</div>
			</div>

			<!-- End Content -->

		</div>
	{% else %}
		<H1 class="head">Group "{{name}}" Does Not Exist!</H1>
		<hr>
		<script type="text/javascript">
			function initializeName(){
				document.getElementById('id_name').value = '{{ name }}';
			}
		</script>
		<div class="head">
			<a class="small round button head" data-reveal-id="createGroupModal" onclick="initializeName()">Create this Group!</a>
		</div>
	{% endif %}
	<div id="editGroupModal" class="reveal-modal medium">
		<FORM id="group_form" method="post" action="/groupcraft/edit_group/">
			{% csrf_token %}

			<fieldset>
				<legend>Group Details</legend>
				<label>Group Title</label>
				<input id="id_name_m" type="text" name="name" maxlength="128" />
				<label>Group Description</label>
				<textarea id="id_description_m" rows="10" cols="40" name="description"></textarea>
				<label>Tags (seperated by spaces)</label>
				<input id="id_tags_m" type="text" name="tags" maxlength="50" />
				<input id="old_name_m" type="hidden" name="old_name" value="{{ name }}" />

				<INPUT type="submit" name="submit" value="Update" />
			</fieldset>
		</FORM>
		<a class="close-reveal-modal">&#215;</a>
	</div>
{% endblock %}